 # Slack ~/.ssh/config
#
# If bastion8.ec2.tinyspeck.com is broken, replace all occurrences with
# bastion9.ec2.tinyspeck.com to get yourself back in business.  If SSH
# is still broken, take it to #ops.

HashKnownHosts no
ServerAliveCountMax 4320
ServerAliveInterval 10
TCPKeepAlive no

# SSH bastion using Duo for 2FA.
# (This stanza must come before other host stanzas.)
Host bastion*.ec2.tinyspeck.com
    ControlMaster auto
    ControlPath /tmp/ssh-control-%r@%h:%p
    ControlPersist 43200
    HostName %h
    ProxyCommand none
    SendEnv DUO_PASSCODE

# Treatment for fully-qualified Slack hostnames.
# (This must come before the short names.)
Host *.slack.com *.tinyspeck.com slack-github.com *.slack-core.com
    HostName %h
    ProxyCommand ssh -q bastion8.ec2.tinyspeck.com nc -q0 %h %p

# Short names for lots of Slack instances.
Host glitch-* slack-*
    HostName %h.ec2.tinyspeck.com
    ProxyCommand ssh -q bastion8.ec2.tinyspeck.com nc -q0 %h %p
Host dev*
    HostName %h.slack.com
    ProxyCommand ssh -q bastion8.ec2.tinyspeck.com nc -q0 %h %p
Host svn
    HostName %h.tinyspeck.com
    ProxyCommand ssh -q bastion8.ec2.tinyspeck.com nc -q0 %h %p
